# Hotel Booking Service

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π backend-—Å–µ—Ä–≤–∏—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª–µ–π –Ω–∞ Spring Framework —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª—å—é CMS, —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–µ–ª—è–º–∏** ‚Äî CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–µ–ª–µ–π
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏** ‚Äî CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–º–µ—Ä–æ–≤ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –æ—Ç–µ–ª—è–º
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äî –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤** ‚Äî –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –æ—Ç–µ–ª—è–º (1-5 –∑–≤–µ–∑–¥)
- ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫** ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –æ—Ç–µ–ª—è–º –∏ –∫–æ–º–Ω–∞—Ç–∞–º
- ‚úÖ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** ‚Äî –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –≤—ã–¥–∞—á–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî Spring Security —Å Basic Auth
- ‚úÖ **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å** ‚Äî USER –∏ ADMIN —Ä–æ–ª–∏
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî —Å–±–æ—Ä —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ Kafka
- ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** ‚Äî –≤—ã–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ CSV

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend
- **Java 17**
- **Spring Boot 3.2.4**
- **Spring Data JPA** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **Spring Security** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **MapStruct 1.5.5** ‚Äî –º–∞–ø–ø–∏–Ω–≥ DTO ‚Üî Entity
- **Lombok** ‚Äî —É–º–µ–Ω—å—à–µ–Ω–∏–µ boilerplate-–∫–æ–¥–∞

### –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL 15** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î
- **MongoDB 7.0** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### Messaging
- **Apache Kafka** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- **Zookeeper** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è Kafka

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Docker & Docker Compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Maven** ‚Äî —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Java JDK 17+**
- **Maven 3.8+**
- **Docker & Docker Compose**
- **8GB RAM** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤
unzip hotel-booking-service.zip
cd hotel-booking-service
```

### 2. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–±–æ—Ä–∫–∞ Maven-–ø—Ä–æ–µ–∫—Ç–∞
mvn clean package -DskipTests

# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ target/ –ø–æ—è–≤–∏—Ç—Å—è hotel-booking-service-1.0-SNAPSHOT.jar
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (PostgreSQL, MongoDB, Kafka, Zookeeper, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f hotel-booking-app
```

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:** `http://localhost:8080`

### 4. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
docker-compose up -d postgres-db mongo-db kafka zookeeper

# 2. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (~30 —Å–µ–∫)

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
mvn spring-boot:run
```

### 5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
docker-compose down -v
```

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hotel-booking-service/
‚îú‚îÄ‚îÄ src/main/java/com/hotelBooking/
‚îÇ   ‚îú‚îÄ‚îÄ HotelBookingApplication.java      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ model/                             # Entities (Hotel, Room, User, Booking)
‚îÇ   ‚îú‚îÄ‚îÄ dto/                               # Data Transfer Objects
‚îÇ   ‚îú‚îÄ‚îÄ repository/                        # Spring Data JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ service/                           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ + MapStruct –º–∞–ø–ø–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ controller/                        # REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ config/                            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (SecurityConfig)
‚îÇ   ‚îú‚îÄ‚îÄ security/                          # UserDetails –∏ UserDetailsService
‚îÇ   ‚îî‚îÄ‚îÄ statistics/                        # –°–ª–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ model/                         # Kafka —Å–æ–±—ã—Ç–∏—è –∏ MongoDB –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ repository/                    # MongoDB —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ service/                       # Kafka consumer –∏ CSV —ç–∫—Å–ø–æ—Ä—Ç
‚îÇ       ‚îî‚îÄ‚îÄ controller/                    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ API
‚îú‚îÄ‚îÄ src/main/resources/
‚îÇ   ‚îî‚îÄ‚îÄ application.properties             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml                     # Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ Dockerfile                             # –û–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ pom.xml                                # Maven –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   hotels    ‚îÇ         ‚îÇ    rooms    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (PK)     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ id (PK)     ‚îÇ
‚îÇ name        ‚îÇ         ‚îÇ hotel_id(FK)‚îÇ
‚îÇ headline    ‚îÇ         ‚îÇ name        ‚îÇ
‚îÇ city        ‚îÇ         ‚îÇ room_number ‚îÇ
‚îÇ address     ‚îÇ         ‚îÇ price       ‚îÇ
‚îÇ distance    ‚îÇ         ‚îÇ max_guests  ‚îÇ
‚îÇ rating      ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ num_ratings ‚îÇ                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ
                               ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ
        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  bookings   ‚îÇ         ‚îÇ    users    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (PK)     ‚îÇ         ‚îÇ id (PK)     ‚îÇ
‚îÇ room_id(FK) ‚îÇ         ‚îÇ username    ‚îÇ
‚îÇ user_id(FK) ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ password    ‚îÇ
‚îÇ check_in    ‚îÇ         ‚îÇ email       ‚îÇ
‚îÇ check_out   ‚îÇ         ‚îÇ role        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
User Request
    ‚Üì
Controller ‚Üí DTO
    ‚Üì
Service ‚Üí MapStruct Mapper ‚Üí Entity
    ‚Üì
Repository ‚Üí Database
    ‚Üì
Service ‚Üí MapStruct Mapper ‚Üí DTO
    ‚Üì
Controller ‚Üí JSON Response
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–π URL

```
http://localhost:8080/api
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ endpoints (–∫—Ä–æ–º–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) —Ç—Ä–µ–±—É—é—Ç **HTTP Basic Auth**:

```
Authorization: Basic <base64(username:password)>
```

---

### üë§ Users API

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
POST /api/users/register
Content-Type: application/json

{
  "username": "john_doe",
  "password": "securePassword123",
  "email": "john@example.com",
  "role": "USER"
}
```

**–†–æ–ª–∏:** `USER` –∏–ª–∏ `ADMIN`

**Response:**
```json
{
  "id": 1,
  "username": "john_doe",
  "email": "john@example.com",
  "role": "USER"
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

```http
GET /api/users/{id}
Authorization: Basic <credentials>
```

#### –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
PUT /api/users/{id}
Authorization: Basic <credentials>
Content-Type: application/json

{
  "username": "john_updated",
  "email": "john.new@example.com",
  "password": "newPassword123",
  "role": "USER"
}
```

---

### üè® Hotels API

#### –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–µ–ª—å –ø–æ ID

```http
GET /api/hotels/{id}
Authorization: Basic <credentials>
```

**Response:**
```json
{
  "id": 1,
  "name": "Grand Hotel",
  "headline": "Luxury 5-star hotel in city center",
  "city": "Moscow",
  "address": "Red Square, 1",
  "distanceFromCenter": 0.5,
  "rating": 4.5,
  "numberOfRatings": 120
}
```

#### –°–æ–∑–¥–∞—Ç—å –æ—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ ADMIN)

```http
POST /api/hotels
Authorization: Basic admin:password
Content-Type: application/json

{
  "name": "Grand Hotel",
  "headline": "Luxury 5-star hotel",
  "city": "Moscow",
  "address": "Red Square, 1",
  "distanceFromCenter": 0.5
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ ADMIN)

```http
PUT /api/hotels/{id}
Authorization: Basic admin:password
Content-Type: application/json

{
  "name": "Grand Hotel Updated",
  "headline": "New headline",
  "city": "Moscow",
  "address": "Red Square, 1",
  "distanceFromCenter": 0.5
}
```

#### –£–¥–∞–ª–∏—Ç—å –æ—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ ADMIN)

```http
DELETE /api/hotels/{id}
Authorization: Basic admin:password
```

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–µ–ª–∏

```http
GET /api/hotels
Authorization: Basic <credentials>
```

#### –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –æ—Ç–µ–ª—è

```http
PUT /api/hotels/{id}/rating
Authorization: Basic <credentials>
Content-Type: application/json

{
  "newMark": 5
}
```

**newMark:** –æ—Ç 1 –¥–æ 5

#### –ü–æ–∏—Å–∫ –æ—Ç–µ–ª–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

```http
GET /api/hotels/search?city=Moscow&minRating=4.0&page=0&pageSize=10
Authorization: Basic <credentials>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- `id` ‚Äî ID –æ—Ç–µ–ª—è
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ)
- `headline` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ)
- `city` ‚Äî –≥–æ—Ä–æ–¥ (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ)
- `address` ‚Äî –∞–¥—Ä–µ—Å (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ)
- `minDistance`, `maxDistance` ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
- `minRating`, `maxRating` ‚Äî —Ä–µ–π—Ç–∏–Ω–≥
- `minNumberOfRatings`, `maxNumberOfRatings` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞—è —Å 0)
- `pageSize` ‚Äî —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**Response:**
```json
{
  "data": [
    {
      "id": 1,
      "name": "Grand Hotel",
      "headline": "Luxury hotel",
      "city": "Moscow",
      "address": "Red Square, 1",
      "distanceFromCenter": 0.5,
      "rating": 4.5,
      "numberOfRatings": 120
    }
  ],
  "totalCount": 1,
  "page": 0,
  "pageSize": 10
}
```

---

### üõè Rooms API

#### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É –ø–æ ID

```http
GET /api/rooms/{id}
Authorization: Basic <credentials>
```

**Response:**
```json
{
  "id": 1,
  "name": "Deluxe Suite",
  "description": "Spacious room with city view",
  "roomNumber": 101,
  "price": 150.0,
  "maxGuests": 2,
  "hotelId": 1,
  "hotelName": "Grand Hotel"
}
```

#### –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ ADMIN)

```http
POST /api/rooms
Authorization: Basic admin:password
Content-Type: application/json

{
  "name": "Deluxe Suite",
  "description": "Spacious room with city view",
  "roomNumber": 101,
  "price": 150.0,
  "maxGuests": 2,
  "hotelId": 1
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ ADMIN)

```http
PUT /api/rooms/{id}
Authorization: Basic admin:password
Content-Type: application/json

{
  "name": "Deluxe Suite Updated",
  "description": "New description",
  "roomNumber": 101,
  "price": 175.0,
  "maxGuests": 3,
  "hotelId": 1
}
```

#### –£–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É (—Ç–æ–ª—å–∫–æ ADMIN)

```http
DELETE /api/rooms/{id}
Authorization: Basic admin:password
```

#### –ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```http
GET /api/rooms/search?hotelId=1&minPrice=100&maxPrice=200&checkIn=2024-12-25&checkOut=2024-12-30&page=0&pageSize=10
Authorization: Basic <credentials>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- `id` ‚Äî ID –∫–æ–º–Ω–∞—Ç—ã
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ)
- `minPrice`, `maxPrice` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω
- `minGuests`, `maxGuests` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π
- `checkIn`, `checkOut` ‚Äî –¥–∞—Ç—ã (YYYY-MM-DD) ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
- `hotelId` ‚Äî ID –æ—Ç–µ–ª—è
- `page`, `pageSize` ‚Äî –ø–∞–≥–∏–Ω–∞—Ü–∏—è

**–í–∞–∂–Ω–æ:** –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–∞–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å **–æ–±–∞** –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (`checkIn` –∏ `checkOut`)

---

### üìÖ Bookings API

#### –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```http
POST /api/bookings
Authorization: Basic <credentials>
Content-Type: application/json

{
  "roomId": 1,
  "userId": 1,
  "checkIn": "2024-12-25",
  "checkOut": "2024-12-30"
}
```

**Response:**
```json
{
  "id": 1,
  "roomId": 1,
  "roomName": "Deluxe Suite",
  "userId": 1,
  "username": "john_doe",
  "checkIn": "2024-12-25",
  "checkOut": "2024-12-30"
}
```

**–û—à–∏–±–∫–∞, –µ—Å–ª–∏ –∫–æ–º–Ω–∞—Ç–∞ –∑–∞–Ω—è—Ç–∞:**
```json
{
  "statusCode": 400,
  "message": "Room is not available for the requested dates"
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ ADMIN)

```http
GET /api/bookings?page=0&pageSize=20
Authorization: Basic admin:password
```

---

### üìä Statistics API

#### –°–∫–∞—á–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ CSV (—Ç–æ–ª—å–∫–æ ADMIN)

```http
GET /api/statistics/export/csv
Authorization: Basic admin:password
```

**–°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª:** `statistics.csv`

**–§–æ—Ä–º–∞—Ç CSV:**
```csv
ID,Event Type,User ID,Check In,Check Out,Created At
1,USER_REGISTRATION,1,,,2024-03-15T10:30:00
2,ROOM_BOOKING,1,2024-12-25,2024-12-30,2024-03-15T11:00:00
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø

| Endpoint | USER | ADMIN |
|----------|------|-------|
| `POST /api/users/register` | ‚úÖ (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) | ‚úÖ (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) |
| `GET /api/hotels/*` | ‚úÖ | ‚úÖ |
| `POST /api/hotels` | ‚ùå | ‚úÖ |
| `PUT /api/hotels/{id}` | ‚ùå | ‚úÖ |
| `DELETE /api/hotels/{id}` | ‚ùå | ‚úÖ |
| `PUT /api/hotels/{id}/rating` | ‚úÖ | ‚úÖ |
| `GET /api/rooms/*` | ‚úÖ | ‚úÖ |
| `POST /api/rooms` | ‚ùå | ‚úÖ |
| `PUT /api/rooms/{id}` | ‚ùå | ‚úÖ |
| `DELETE /api/rooms/{id}` | ‚ùå | ‚úÖ |
| `POST /api/bookings` | ‚úÖ | ‚úÖ |
| `GET /api/bookings` | ‚ùå | ‚úÖ |
| `GET /api/statistics/export/csv` | ‚ùå | ‚úÖ |

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```http
POST /api/users/register
Content-Type: application/json

{
  "username": "admin",
  "password": "adminPassword",
  "email": "admin@hotel.com",
  "role": "ADMIN"
}
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–æ–±—ã—Ç–∏—è, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–æ–π:

1. **USER_REGISTRATION** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: `userId`

2. **ROOM_BOOKING** ‚Äî –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: `userId`, `checkIn`, `checkOut`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```
Registration/Booking
        ‚Üì
    Kafka Producer
        ‚Üì
    Kafka Topics
        ‚Üì
    Kafka Consumer
        ‚Üì
    MongoDB (JSON)
        ‚Üì
    CSV Export Service
        ‚Üì
    CSV File Download
```

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –æ—Ç–µ–ª—è

```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST http://localhost:8080/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "alice",
    "password": "password123",
    "email": "alice@example.com",
    "role": "USER"
  }'

# 2. –ü–æ–∏—Å–∫ –æ—Ç–µ–ª–µ–π –≤ –ú–æ—Å–∫–≤–µ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º –≤—ã—à–µ 4.0
curl -X GET "http://localhost:8080/api/hotels/search?city=Moscow&minRating=4.0" \
  -u alice:password123

# 3. –û—Ü–µ–Ω–∏—Ç—å –æ—Ç–µ–ª—å
curl -X PUT http://localhost:8080/api/hotels/1/rating \
  -u alice:password123 \
  -H "Content-Type: application/json" \
  -d '{"newMark": 5}'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–µ–ª—å –∏ –∫–æ–º–Ω–∞—Ç—ã

```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
curl -X POST http://localhost:8080/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123",
    "email": "admin@hotel.com",
    "role": "ADMIN"
  }'

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–µ–ª—è
curl -X POST http://localhost:8080/api/hotels \
  -u admin:admin123 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Paradise Resort",
    "headline": "Beachfront luxury resort",
    "city": "Sochi",
    "address": "Beach Street, 10",
    "distanceFromCenter": 5.0
  }'

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
curl -X POST http://localhost:8080/api/rooms \
  -u admin:admin123 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Ocean View Suite",
    "description": "Beautiful ocean view",
    "roomNumber": 201,
    "price": 250.0,
    "maxGuests": 2,
    "hotelId": 1
  }'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã

```bash
# 1. –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç –Ω–∞ –¥–∞—Ç—ã 25-30 –¥–µ–∫–∞–±—Ä—è
curl -X GET "http://localhost:8080/api/rooms/search?checkIn=2024-12-25&checkOut=2024-12-30" \
  -u alice:password123

# 2. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
curl -X POST http://localhost:8080/api/bookings \
  -u alice:password123 \
  -H "Content-Type: application/json" \
  -d '{
    "roomId": 1,
    "userId": 1,
    "checkIn": "2024-12-25",
    "checkOut": "2024-12-30"
  }'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```bash
# –°–∫–∞—á–∞—Ç—å CSV-—Ñ–∞–π–ª —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
curl -X GET http://localhost:8080/api/statistics/export/csv \
  -u admin:admin123 \
  -o statistics.csv
```

## üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

- **200 OK** ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
- **201 Created** ‚Äî —Ä–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω
- **204 No Content** ‚Äî —Ä–µ—Å—É—Ä—Å —É–¥–∞–ª—ë–Ω
- **400 Bad Request** ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞
- **404 Not Found** ‚Äî —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **500 Internal Server Error** ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

**404 Not Found:**
```json
{
  "statusCode": 404,
  "message": "Hotel not found with id: 999"
}
```

**400 Bad Request:**
```json
{
  "statusCode": 400,
  "message": "Username already exists: john_doe"
}
```

**400 Bad Request (–≤–∞–ª–∏–¥–∞—Ü–∏—è):**
```json
{
  "statusCode": 400,
  "message": "Rating must be between 1 and 5"
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### application.properties

```properties
# PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/hotel_booking_db
spring.datasource.username=postgres
spring.datasource.password=postgres

# MongoDB
spring.data.mongodb.uri=mongodb://localhost:27017
spring.data.mongodb.database=hotel_statistics_db

# Kafka
spring.kafka.bootstrap-servers=localhost:9092
app.kafka.topic.user-registration=user-registration-topic
app.kafka.topic.room-booking=room-booking-topic
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f hotel-booking-app

# –õ–æ–≥–∏ PostgreSQL
docker-compose logs -f postgres-db

# –õ–æ–≥–∏ Kafka
docker-compose logs -f kafka
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
mvn test
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# PostgreSQL
docker exec -it hotel-postgres psql -U postgres -c "\l"

# MongoDB
docker exec -it hotel-mongo mongosh --eval "show dbs"

# Kafka topics
docker exec -it hotel-kafka kafka-topics --list --bootstrap-server localhost:9092
```

## ü§ù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ü–∏—è

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–ª–µ–¥—É–π—Ç–µ:
- –°–ª–æ–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (Controller ‚Üí Service ‚Üí Repository)
- –ü—Ä–∏–Ω—Ü–∏–ø–∞–º SOLID
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é DTO –¥–ª—è –≤—Å–µ—Ö API endpoints
- –û–±—Ä–∞–±–æ—Ç–∫–µ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ `@ControllerAdvice`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∫—É—Ä—Å–∞ ¬´–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ Spring Framework¬ª

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∫—É—Ä—Å–∞ Spring Framework**
